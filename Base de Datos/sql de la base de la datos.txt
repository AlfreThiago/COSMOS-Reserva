CREATE TABLE rol (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

CREATE TABLE categoria (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

CREATE TABLE producto (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR (255),
    imagen VARCHAR(255) NOT NULL,
    id_cat INT NOT NULL, FOREIGN KEY (id_cat) REFERENCES categoria(id)
);

CREATE TABLE usuario (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    contrasena VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    rol_id INT, FOREIGN KEY (rol_id) REFERENCES rol(id)
);

CREATE TABLE estado(
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

CREATE TABLE solicitud (
    id INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(200) NOT NULL,
    cliente_id INT NOT NULL, FOREIGN KEY (cliente_id) REFERENCES usuario(id),
    tecnico_id INT NULL, FOREIGN KEY (tecnico_id) REFERENCES usuario(id),
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    fecha_actualizacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    prioridad ENUM ('baja', 'media', 'alta', 'urgente') DEFAULT 'media',
    producto_id INT NOT NULL, FOREIGN KEY (producto_id) REFERENCES producto(id),
    estado_id INT, FOREIGN KEY (estado_id) REFERENCES estado(id),
    descripcion TEXT NOT NULL
);

CREATE TABLE historial (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario VARCHAR(100),
    usuario_id INT,
    accion VARCHAR(100),
    item VARCHAR(100),
    item_id INT,
    fecha_hora timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;
    obs VARCHAR(255)
):

INSERT INTO `estado`(`id`, `nombre`) VALUES ('1','Disponible');
INSERT INTO `estado`(`id`, `nombre`) VALUES ('2','En diagonostico');
INSERT INTO `estado`(`id`, `nombre`) VALUES ('3','En espera de repuestos');
INSERT INTO `estado`(`id`, `nombre`) VALUES ('4','En reparacion');
INSERT INTO `estado`(`id`, `nombre`) VALUES ('5','Finalizado');